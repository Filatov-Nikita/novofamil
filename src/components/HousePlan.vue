<template>
  <div class="tw-overflow-x-scroll app-scroll-x app-scroll-y tw-relative xl:tw-max-w-[930px] 2xl:tw-max-w-[1200px] xl:tw-ml-auto">
    <img class="lg:tw-mx-0 tw-max-w-none tw-w-auto hfull" ref="img" width="2830" height="1428" src="@/assets/images/house-fasad.jpg" />
    <PopupTouchMove v-if="tappable && showTouchPopup" @hide="showTouchPopup = false"/>

    <svg ref="svg" class="tw-absolute hfull tw-inset-0 lg:tw-mx-0" viewBox="0 0 1415 714">
      <g
        v-for="(path, i) in paths"
        style="mix-blend-mode: multiply"
        :key="i"
        :opacity="active === storeyId(i) ? 0.4 : 0"
      >
        <path
          :d="path"
          fill="#0AB81B"
          @click="onClick($event, storeyId(i))"
          @mouseenter="onEnter($event, storeyId(i))"
          @mouseleave="onLeave($event, storeyId(i))" />
        />
      </g>
      <g>
        <path d="M1032 115.386L1004.98 96.1139C1004.98 96.1134 1004.98 96.1129 1004.98 96.1124C1003.66 95.1493 1002.58 94.0044 1001.74 92.6769C1000.91 91.3763 1000.5 89.9326 1000.5 88.3333L1000.5 39.9167C1000.5 38.1469 1001.12 36.645 1002.37 35.3838C1003.62 34.1228 1005.11 33.5 1006.86 33.5L1057.14 33.5C1058.89 33.5 1060.38 34.1228 1061.63 35.3838C1062.88 36.645 1063.5 38.1469 1063.5 39.9167L1063.5 88.3333C1063.5 89.9326 1063.09 91.3763 1062.26 92.6769C1061.42 94.0044 1060.34 95.1494 1059.02 96.1124C1059.02 96.1129 1059.02 96.1134 1059.02 96.1139L1032 115.386Z" fill="white" stroke="#9FB7BC"/>
        <path d="M1015.68 52.3408L1016.89 52.498C1016.76 53.332 1016.42 53.986 1015.88 54.46C1015.33 54.9294 1014.67 55.1641 1013.87 55.1641C1012.88 55.1641 1012.08 54.8405 1011.47 54.1934C1010.87 53.5417 1010.57 52.6097 1010.57 51.3975C1010.57 50.6136 1010.7 49.9277 1010.96 49.3398C1011.22 48.752 1011.61 48.3122 1012.14 48.0205C1012.68 47.7243 1013.26 47.5762 1013.88 47.5762C1014.67 47.5762 1015.31 47.7767 1015.81 48.1777C1016.32 48.5742 1016.64 49.1393 1016.78 49.873L1015.58 50.0576C1015.47 49.57 1015.27 49.2031 1014.97 48.957C1014.69 48.7109 1014.34 48.5879 1013.93 48.5879C1013.31 48.5879 1012.8 48.8112 1012.42 49.2578C1012.03 49.6999 1011.84 50.4017 1011.84 51.3633C1011.84 52.3385 1012.02 53.0472 1012.4 53.4893C1012.77 53.9313 1013.26 54.1523 1013.86 54.1523C1014.34 54.1523 1014.75 54.0042 1015.07 53.708C1015.39 53.4118 1015.6 52.9561 1015.68 52.3408ZM1022.64 52.6621L1023.91 52.8193C1023.71 53.5622 1023.34 54.1387 1022.79 54.5488C1022.25 54.959 1021.56 55.1641 1020.72 55.1641C1019.65 55.1641 1018.81 54.8382 1018.19 54.1865C1017.57 53.5303 1017.26 52.612 1017.26 51.4316C1017.26 50.2103 1017.57 49.2624 1018.2 48.5879C1018.83 47.9134 1019.64 47.5762 1020.65 47.5762C1021.62 47.5762 1022.41 47.9066 1023.03 48.5674C1023.64 49.2282 1023.95 50.1579 1023.95 51.3564C1023.95 51.4294 1023.95 51.5387 1023.94 51.6846H1018.53C1018.57 52.4821 1018.8 53.0928 1019.21 53.5166C1019.61 53.9404 1020.12 54.1523 1020.72 54.1523C1021.17 54.1523 1021.56 54.0339 1021.88 53.7969C1022.2 53.5599 1022.45 53.1816 1022.64 52.6621ZM1018.6 50.6729H1022.65C1022.6 50.0622 1022.44 49.6042 1022.19 49.2988C1021.79 48.8249 1021.29 48.5879 1020.66 48.5879C1020.1 48.5879 1019.62 48.777 1019.23 49.1553C1018.85 49.5335 1018.64 50.0394 1018.6 50.6729ZM1025.17 47.7402H1026.4V50.8779C1026.8 50.8779 1027.07 50.8027 1027.22 50.6523C1027.38 50.502 1027.62 50.0645 1027.92 49.3398C1028.16 48.7656 1028.36 48.3874 1028.51 48.2051C1028.66 48.0228 1028.83 47.8997 1029.03 47.8359C1029.22 47.7721 1029.54 47.7402 1029.97 47.7402H1030.22V48.7588L1029.88 48.752C1029.55 48.752 1029.35 48.7998 1029.25 48.8955C1029.16 48.9958 1029.01 49.2943 1028.82 49.791C1028.63 50.265 1028.46 50.5931 1028.3 50.7754C1028.15 50.9577 1027.91 51.124 1027.59 51.2744C1028.11 51.4157 1028.63 51.9079 1029.14 52.751L1030.49 55H1029.14L1027.83 52.751C1027.56 52.2998 1027.32 52.0036 1027.12 51.8623C1026.92 51.7165 1026.68 51.6436 1026.4 51.6436V55H1025.17V47.7402ZM1031.05 47.7402H1032.28V53.9883H1035.68V47.7402H1036.91V53.9883H1037.7V57.0576H1036.69V55H1031.05V47.7402ZM1038.77 47.7402H1040V53.2773L1043.41 47.7402H1044.74V55H1043.51V49.4971L1040.1 55H1038.77V47.7402ZM1052.03 47.7402V55H1050.8V52.1699H1050.09C1049.66 52.1699 1049.33 52.2269 1049.12 52.3408C1048.91 52.4502 1048.6 52.8079 1048.2 53.4141L1047.12 55H1045.6L1046.93 53.0449C1047.33 52.4479 1047.73 52.1107 1048.14 52.0332C1047.43 51.9375 1046.91 51.6846 1046.57 51.2744C1046.23 50.8643 1046.06 50.3926 1046.06 49.8594C1046.06 49.2305 1046.29 48.7201 1046.73 48.3281C1047.17 47.9362 1047.82 47.7402 1048.66 47.7402H1052.03ZM1050.8 48.7588H1049.05C1048.32 48.7588 1047.84 48.8727 1047.63 49.1006C1047.42 49.3285 1047.32 49.5951 1047.32 49.9004C1047.32 50.3333 1047.47 50.6523 1047.78 50.8574C1048.09 51.0579 1048.65 51.1582 1049.44 51.1582H1050.8V48.7588Z" fill="#9FB7BC"/>
        <path d="M1033.72 72.504C1032.93 73.4213 1031.97 74.1467 1030.84 74.68C1029.73 75.2133 1028.45 75.48 1027 75.48V73.464C1027.87 73.464 1028.7 73.3147 1029.49 73.016C1030.28 72.7173 1030.98 72.2907 1031.57 71.736C1032.17 71.1813 1032.66 70.5093 1033.05 69.72C1033.43 68.9307 1033.66 68.0453 1033.75 67.064H1035.61V79.064V91.128H1033.72V79.064V72.504Z" fill="#4C7D86"/>
        <path d="M689 181.386L661.98 162.114C661.979 162.113 661.979 162.113 661.978 162.112C660.657 161.149 659.578 160.004 658.737 158.677C657.913 157.376 657.5 155.933 657.5 154.333L657.5 105.917C657.5 104.147 658.119 102.645 659.369 101.384C660.62 100.123 662.106 99.5 663.857 99.5L714.143 99.5C715.894 99.5 717.38 100.123 718.631 101.384C719.881 102.645 720.5 104.147 720.5 105.917L720.5 154.333C720.5 155.933 720.087 157.376 719.263 158.677C718.422 160.004 717.343 161.149 716.022 162.112C716.021 162.113 716.021 162.113 716.02 162.114L689 181.386Z" fill="white" stroke="#9FB7BC"/>
        <path d="M672.684 118.341L673.894 118.498C673.762 119.332 673.423 119.986 672.876 120.46C672.333 120.929 671.666 121.164 670.873 121.164C669.879 121.164 669.08 120.84 668.473 120.193C667.872 119.542 667.571 118.61 667.571 117.397C667.571 116.614 667.701 115.928 667.961 115.34C668.221 114.752 668.615 114.312 669.143 114.021C669.677 113.724 670.255 113.576 670.88 113.576C671.668 113.576 672.313 113.777 672.814 114.178C673.316 114.574 673.637 115.139 673.778 115.873L672.582 116.058C672.468 115.57 672.265 115.203 671.973 114.957C671.686 114.711 671.338 114.588 670.928 114.588C670.308 114.588 669.804 114.811 669.417 115.258C669.029 115.7 668.836 116.402 668.836 117.363C668.836 118.339 669.023 119.047 669.396 119.489C669.77 119.931 670.258 120.152 670.859 120.152C671.342 120.152 671.746 120.004 672.069 119.708C672.393 119.412 672.598 118.956 672.684 118.341ZM679.637 118.662L680.908 118.819C680.708 119.562 680.336 120.139 679.794 120.549C679.252 120.959 678.559 121.164 677.716 121.164C676.654 121.164 675.811 120.838 675.187 120.187C674.567 119.53 674.257 118.612 674.257 117.432C674.257 116.21 674.571 115.262 675.2 114.588C675.829 113.913 676.645 113.576 677.648 113.576C678.618 113.576 679.411 113.907 680.026 114.567C680.642 115.228 680.949 116.158 680.949 117.356C680.949 117.429 680.947 117.539 680.942 117.685H675.528C675.574 118.482 675.8 119.093 676.205 119.517C676.611 119.94 677.117 120.152 677.723 120.152C678.174 120.152 678.559 120.034 678.878 119.797C679.197 119.56 679.45 119.182 679.637 118.662ZM675.597 116.673H679.65C679.596 116.062 679.441 115.604 679.186 115.299C678.794 114.825 678.286 114.588 677.661 114.588C677.096 114.588 676.62 114.777 676.233 115.155C675.85 115.534 675.638 116.039 675.597 116.673ZM682.173 113.74H683.404V116.878C683.796 116.878 684.069 116.803 684.224 116.652C684.383 116.502 684.616 116.064 684.921 115.34C685.163 114.766 685.359 114.387 685.509 114.205C685.66 114.023 685.833 113.9 686.029 113.836C686.225 113.772 686.539 113.74 686.972 113.74H687.218V114.759L686.876 114.752C686.553 114.752 686.345 114.8 686.254 114.896C686.159 114.996 686.013 115.294 685.817 115.791C685.63 116.265 685.459 116.593 685.304 116.775C685.149 116.958 684.91 117.124 684.586 117.274C685.115 117.416 685.634 117.908 686.145 118.751L687.492 121H686.138L684.826 118.751C684.557 118.3 684.322 118.004 684.121 117.862C683.921 117.716 683.682 117.644 683.404 117.644V121H682.173V113.74ZM688.046 113.74H689.276V119.988H692.68V113.74H693.911V119.988H694.704V123.058H693.692V121H688.046V113.74ZM695.77 113.74H697.001V119.277L700.412 113.74H701.738V121H700.508V115.497L697.097 121H695.77V113.74ZM709.026 113.74V121H707.802V118.17H707.091C706.658 118.17 706.335 118.227 706.12 118.341C705.911 118.45 705.603 118.808 705.197 119.414L704.124 121H702.6L703.926 119.045C704.332 118.448 704.735 118.111 705.136 118.033C704.434 117.938 703.912 117.685 703.571 117.274C703.233 116.864 703.065 116.393 703.065 115.859C703.065 115.23 703.286 114.72 703.728 114.328C704.174 113.936 704.819 113.74 705.662 113.74H709.026ZM707.802 114.759H706.052C705.318 114.759 704.844 114.873 704.63 115.101C704.42 115.328 704.316 115.595 704.316 115.9C704.316 116.333 704.471 116.652 704.78 116.857C705.095 117.058 705.649 117.158 706.442 117.158H707.802V114.759Z" fill="#9FB7BC"/>
        <path d="M682.26 145.064C682.751 144.211 683.337 143.443 684.02 142.76C684.724 142.056 685.492 141.459 686.324 140.968C687.156 140.477 688.041 140.104 688.98 139.848C689.94 139.571 690.932 139.432 691.956 139.432C692.532 139.432 693.023 139.219 693.428 138.792C693.833 138.365 694.036 137.843 694.036 137.224C694.036 136.648 693.833 136.147 693.428 135.72C693.044 135.272 692.564 135.048 691.988 135.048H681.14V133H691.988C692.521 133 693.033 133.117 693.524 133.352C694.015 133.565 694.441 133.864 694.804 134.248C695.167 134.632 695.455 135.08 695.668 135.592C695.881 136.104 695.988 136.648 695.988 137.224C695.988 137.8 695.881 138.344 695.668 138.856C695.476 139.368 695.199 139.816 694.836 140.2C694.473 140.584 694.036 140.893 693.524 141.128C693.033 141.341 692.511 141.448 691.956 141.448C690.377 141.448 688.969 141.779 687.732 142.44C686.516 143.101 685.481 143.976 684.628 145.064C683.924 145.981 683.369 146.995 682.964 148.104C682.58 149.213 682.388 150.333 682.388 151.464V155.112H696.564V157.128H680.5V151.464C680.5 150.269 680.649 149.139 680.948 148.072C681.247 147.005 681.684 146.003 682.26 145.064Z" fill="#4C7D86"/>
        <path d="M381 138.386L353.98 119.114C353.979 119.113 353.979 119.113 353.978 119.112C352.657 118.149 351.578 117.004 350.737 115.677C349.913 114.376 349.5 112.933 349.5 111.333L349.5 62.9167C349.5 61.1469 350.119 59.645 351.369 58.3838C352.62 57.1228 354.106 56.5 355.857 56.5L406.143 56.5C407.894 56.5 409.38 57.1228 410.631 58.3838C411.881 59.645 412.5 61.1469 412.5 62.9167L412.5 111.333C412.5 112.933 412.087 114.376 411.263 115.677C410.422 117.004 409.343 118.149 408.022 119.112C408.021 119.113 408.021 119.113 408.02 119.114L381 138.386Z" fill="white" stroke="#9FB7BC"/>
        <path d="M364.684 75.3408L365.894 75.498C365.762 76.332 365.423 76.986 364.876 77.46C364.333 77.9294 363.666 78.1641 362.873 78.1641C361.879 78.1641 361.08 77.8405 360.473 77.1934C359.872 76.5417 359.571 75.6097 359.571 74.3975C359.571 73.6136 359.701 72.9277 359.961 72.3398C360.221 71.752 360.615 71.3122 361.143 71.0205C361.677 70.7243 362.255 70.5762 362.88 70.5762C363.668 70.5762 364.313 70.7767 364.814 71.1777C365.316 71.5742 365.637 72.1393 365.778 72.873L364.582 73.0576C364.468 72.57 364.265 72.2031 363.973 71.957C363.686 71.7109 363.338 71.5879 362.928 71.5879C362.308 71.5879 361.804 71.8112 361.417 72.2578C361.029 72.6999 360.836 73.4017 360.836 74.3633C360.836 75.3385 361.023 76.0472 361.396 76.4893C361.77 76.9313 362.258 77.1523 362.859 77.1523C363.342 77.1523 363.746 77.0042 364.069 76.708C364.393 76.4118 364.598 75.9561 364.684 75.3408ZM371.637 75.6621L372.908 75.8193C372.708 76.5622 372.336 77.1387 371.794 77.5488C371.252 77.959 370.559 78.1641 369.716 78.1641C368.654 78.1641 367.811 77.8382 367.187 77.1865C366.567 76.5303 366.257 75.612 366.257 74.4316C366.257 73.2103 366.571 72.2624 367.2 71.5879C367.829 70.9134 368.645 70.5762 369.648 70.5762C370.618 70.5762 371.411 70.9066 372.026 71.5674C372.642 72.2282 372.949 73.1579 372.949 74.3564C372.949 74.4294 372.947 74.5387 372.942 74.6846H367.528C367.574 75.4821 367.8 76.0928 368.205 76.5166C368.611 76.9404 369.117 77.1523 369.723 77.1523C370.174 77.1523 370.559 77.0339 370.878 76.7969C371.197 76.5599 371.45 76.1816 371.637 75.6621ZM367.597 73.6729H371.65C371.596 73.0622 371.441 72.6042 371.186 72.2988C370.794 71.8249 370.286 71.5879 369.661 71.5879C369.096 71.5879 368.62 71.777 368.233 72.1553C367.85 72.5335 367.638 73.0394 367.597 73.6729ZM374.173 70.7402H375.404V73.8779C375.796 73.8779 376.069 73.8027 376.224 73.6523C376.383 73.502 376.616 73.0645 376.921 72.3398C377.163 71.7656 377.359 71.3874 377.509 71.2051C377.66 71.0228 377.833 70.8997 378.029 70.8359C378.225 70.7721 378.539 70.7402 378.972 70.7402H379.218V71.7588L378.876 71.752C378.553 71.752 378.345 71.7998 378.254 71.8955C378.159 71.9958 378.013 72.2943 377.817 72.791C377.63 73.265 377.459 73.5931 377.304 73.7754C377.149 73.9577 376.91 74.124 376.586 74.2744C377.115 74.4157 377.634 74.9079 378.145 75.751L379.492 78H378.138L376.826 75.751C376.557 75.2998 376.322 75.0036 376.121 74.8623C375.921 74.7165 375.682 74.6436 375.404 74.6436V78H374.173V70.7402ZM380.046 70.7402H381.276V76.9883H384.68V70.7402H385.911V76.9883H386.704V80.0576H385.692V78H380.046V70.7402ZM387.77 70.7402H389.001V76.2773L392.412 70.7402H393.738V78H392.508V72.4971L389.097 78H387.77V70.7402ZM401.026 70.7402V78H399.802V75.1699H399.091C398.658 75.1699 398.335 75.2269 398.12 75.3408C397.911 75.4502 397.603 75.8079 397.197 76.4141L396.124 78H394.6L395.926 76.0449C396.332 75.4479 396.735 75.1107 397.136 75.0332C396.434 74.9375 395.912 74.6846 395.571 74.2744C395.233 73.8643 395.065 73.3926 395.065 72.8594C395.065 72.2305 395.286 71.7201 395.728 71.3281C396.174 70.9362 396.819 70.7402 397.662 70.7402H401.026ZM399.802 71.7588H398.052C397.318 71.7588 396.844 71.8727 396.63 72.1006C396.42 72.3285 396.316 72.5951 396.316 72.9004C396.316 73.3333 396.471 73.6523 396.78 73.8574C397.095 74.0579 397.649 74.1582 398.442 74.1582H399.802V71.7588Z" fill="#9FB7BC"/>
        <path d="M386.109 102.064C385.554 100.976 384.765 100.101 383.741 99.44C382.738 98.7787 381.618 98.448 380.381 98.448H374.685V96.432H380.381C380.978 96.432 381.469 96.2187 381.853 95.792C382.258 95.3653 382.461 94.8427 382.461 94.224C382.461 93.6267 382.258 93.1147 381.853 92.688C381.469 92.2613 380.978 92.048 380.381 92.048H374.685V90H380.381C380.957 90 381.48 90.1173 381.949 90.352C382.44 90.5653 382.866 90.864 383.229 91.248C383.592 91.632 383.869 92.08 384.061 92.592C384.274 93.104 384.381 93.648 384.381 94.224C384.381 94.8853 384.274 95.44 384.061 95.888C383.848 96.336 383.624 96.7093 383.389 97.008C384.349 97.392 385.277 98.0107 386.173 98.864C387.069 99.696 387.762 100.763 388.253 102.064C388.616 103.024 388.797 104.101 388.797 105.296C388.797 106.491 388.584 107.621 388.157 108.688C387.73 109.755 387.133 110.693 386.365 111.504C385.618 112.315 384.733 112.965 383.709 113.456C382.685 113.925 381.576 114.16 380.381 114.16C379.016 114.16 377.81 113.893 376.765 113.36C375.72 112.805 374.834 112.091 374.109 111.216C373.405 110.341 372.872 109.349 372.509 108.24C372.146 107.109 371.965 105.968 371.965 104.816H373.917C373.917 105.733 374.056 106.629 374.333 107.504C374.61 108.379 375.016 109.157 375.549 109.84C376.104 110.523 376.786 111.077 377.597 111.504C378.408 111.909 379.336 112.112 380.381 112.112C381.277 112.112 382.12 111.941 382.909 111.6C383.698 111.237 384.381 110.747 384.957 110.128C385.554 109.509 386.024 108.784 386.365 107.952C386.706 107.12 386.877 106.235 386.877 105.296C386.877 104.144 386.621 103.067 386.109 102.064Z" fill="#4C7D86"/>
      </g>
    </svg>
  </div>
</template>

<script>
import { throttle } from 'throttle-debounce';
import PopupTouchMove from './PopupTouchMove.vue'

export default {
  props: {
    height: {
      required: true,
      type: String,
    },
    width: {
      required: true,
      type: String,
    },
    activeStorey: {
      default: undefined,
    },
  },
  emits: ["enter", "leave"],
  components: {
    PopupTouchMove
  },
  mounted() {
    // this.calcStyles();
    // this.$refs.img.addEventListener('load', this.calcStyles);
    // this.resizer = throttle(500, this.calcStyles);
    // window.addEventListener('resize', this.resizer);
  },
  beforeUnmount() {
    window.removeEventListener('resize', this.resizer);
  },
  data() {
    return {
      showTouchPopup: true,
      active: null,
      resizer: null,
      paths1: [
        'M308 618L454 609.5V638.5L308 642V618Z',
        'M308 589.5L454 574V609.5L308 618V589.5Z',
        'M308 558L454 534.5V574L308 589.5V558Z',
        'M308 528.5L454 495.5V534.5L308 558V528.5Z',
        'M308 496.5L454 457.5V495.5L308 528.5V496.5Z',
        'M308 463.5L454 418.5V457.5L308 496.5V463.5Z',
        'M308 431L454 381V418.5L308 463.5V431Z',
        'M308 401.5L454 341.5V381L308 431V401.5Z',
        'M308 368L454 302.5V341.5L308 401.5V368Z',
        'M308 333.5L454 262V302.5L308 368V333.5Z',
        'M308 299L454 222V262L308 333.5V299Z',
        'M308 268L454 182V222L308 299V268Z',
        'M308 237L454 145V182L308 268V237Z',
      ],
      paths2: [
        'M454 609.5L820.754 594.5L965 607V639.5L820.754 633.511L454 638.5V609.5Z',
        'M454 573.5L821 541L965 563V607L821 594.5L454 609.5V573.5Z',
        'M454 534.5L821 482.5L965 518V563L821 541L454 573.5V534.5Z',
        'M454 495.5L821 425L965 474V518L821 482.5L454 534.5V495.5Z',
        'M454 457.5L821 372.5L965 433V474L821 425L454 495.5V457.5Z',
        'M454 418.5L821 318.5L965 390V433L821 372.5L454 457.5V418.5Z',
        'M454 381L821 261L965 347V390L821 318.5L454 418.5V',
        'M454 341.5L821 211.5L965 306V347L821 261L454 381V341.5Z',
        'M454 302.5L821 152L965 262V306L821 211.5L454 341.5V302.5Z',
      ],
      paths3: [
        'M965 607L1099 618.5V645L965 639.5V607Z',
        'M965 563L1099 587.5V618.5L965 607V563Z',
        'M965 518L1099 555.5V587.5L965 563V518Z',
        'M965 474L1099 523.5V555.5L965 518V474Z',
        'M965 433L1099 492.5V523.5L965 474V433Z',
        'M965 390L1099 461.5V492.5L965 433V390Z',
        'M965 347L1099 429.5V461.5L965 390V347Z',
        'M965 306L1099 396.5V429.5L965 347V306Z',
        'M965 262L1099 362.5V396.5L965 306V262Z',
        'M965 219.5L1099 331.5V362.5L965 262V219.5Z',
        'M965 176L1099 300.5V331.5L965 219.5V176Z',
        'M965 126L1099 263.5V300.5L965 176.5V126Z',
      ],
    };
  },
  computed: {
    paths() {
      return this.paths3.concat(this.paths2).concat(this.paths1);
    },
    tappable() {
      return this.$screen.touch;
    },
  },
  methods: {
    storeyId(i) {
      return i + 1;
    },
    calcStyles() {
      const ratio = 1415 / 714;
      const w = window.innerWidth;
      const h = window.innerHeight - 97 - 81;

      const w2 = ratio * h;

      if(w2 < w) {
        this.$refs.img.style.width = w + 'px';
        this.$refs.img.style.height = 'auto';
      } else {
        this.$refs.img.style.height = h + 'px';
        this.$refs.img.style.width = 'auto';
      }

      setTimeout(() => {
        const computed = getComputedStyle(this.$refs.img);
        this.$refs.svg.style.width = computed.width;
        this.$refs.svg.style.height = computed.height;
      }, 0);
    },
    onClick(e, id) {
      this.active = id;
      if (this.tappable && this.activeStorey?.id !== id) {
        return this.$emit("enter", id);
      }
      this.$router.push({ name: "storey", params: { id: id } });
    },
    onEnter(e, id) {
      if (!this.tappable) {
        this.active = id;
        return this.$emit("enter", id);
      }
    },
    onLeave(e, id) {
      if (!this.tappable) {
        this.active = null;
        return this.$emit("leave", id);
      }
    },
  },
};
</script>
<style scoped>
  .hfull {
    min-height: 600px;
    height: calc(100vh - 97px - 81px);
  }

  @screen 2xl {
    .hfull {
      min-height: 610px;
    }
  }
</style>
